<!DOCTYPE html>
<html lang="zxx" class="no-js">

<head>
   <!-- Mobile Specific Meta -->
   <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
   <!-- Favicon-->
   <link rel="shortcut icon" href="/assets/imgs/theme/willink-watches-logo (2).png">
   <!-- Author Meta -->
   <meta name="author" content="CodePixar">
   <!-- Meta Description -->
   <meta name="description" content="">
   <!-- Meta Keyword -->
   <meta name="keywords" content="">
   <!-- meta character set -->
   <meta charset="UTF-8">
   <!-- Site Title -->
   <title>Willink Watches</title>

   <!--
            CSS
            ============================================= -->
   <link rel="stylesheet" href="/user-assets/css/linearicons.css">
   <link rel="stylesheet" href="/user-assets/css/owl.carousel.css">
   <link rel="stylesheet" href="/user-assets/css/font-awesome.min.css">
   <link rel="stylesheet" href="/user-assets/css/themify-icons.css">
   <link rel="stylesheet" href="/user-assets/css/nice-select.css">
   <link rel="stylesheet" href="/user-assets/css/nouislider.min.css">
   <link rel="stylesheet" href="/user-assets/css/bootstrap.css">
   <link rel="stylesheet" href="/user-assets/css/main.css">
   <link rel="stylesheet" href="/user-assets/css/user-profile.css">
   <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.3.0/font/bootstrap-icons.css">
   <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.5.2/dist/css/bootstrap.min.css">
   <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.7.23/dist/sweetalert2.all.min.js"></script>
   <link href="https://cdn.jsdelivr.net/npm/sweetalert2@11.7.23/dist/sweetalert2.min.css" rel="stylesheet">
   

</head>

<body>

   <!-- Start Header Area -->
   <header class="header_area sticky-header">
      <div class="main_menu">
         <nav class="navbar navbar-expand-lg navbar-light main_box" style="border-radius: 25px; background-color: #f1f0f0;">
            <div class="container">
                <!-- Brand and toggle get grouped for better mobile display -->
                <a class="navbar-brand logo_h" href="/home">
						<div class="" style="height: 80px;">
							<img src="/assets/imgs/theme/willink-watches-logo (2).png" style="height: 80px; width: 100%; object-fit: cover;" alt="">
						</div>
                </a>
                <button class="navbar-toggler" type="button" data-toggle="collapse"
                    data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent"
                    aria-expanded="false" aria-label="Toggle navigation">
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <!-- Collect the nav links, forms, and other content for toggling -->
                <div class="collapse navbar-collapse offset" id="navbarSupportedContent">
                  <ul class="nav navbar-nav d-flex align-items-center  menu_nav ml-auto">
							<li class="nav-item active"><a href="/home" class="profile-icon nav-link"><span
								style="font-size: 22px; width: 30px; height: 30px; color: rgb(0, 0, 0);"
								class="bi bi-house"></span></a></li>
							<li class="nav-item"><a href="/show-all-products" class="profile-icon nav-link"><span
								style="font-size: 22px; width: 30px; height: 30px; color: black;"
								class="bi bi-shop"></span></a></li>
							<li class="nav-item"><a href="/user-profile" class="profile-icon nav-link"><span
										style="font-size: 22px; width: 30px; height: 30px; color: rgb(219, 134, 7);"
										class="bi bi-person"></span></a></li>
							<li class="nav-item"><a href="/cart" class="profile-icon nav-link"><span
										style="font-size: 20px; width: 30px; height: 30px; color: black;"
										class="bi bi-cart"></span>
                              <span id="cartItemsCount" class="badge badge-danger position-absolute top-0 start-50 translate-middle"><%- cartItemsCount %></span>
                           </a></li>
							<li class="nav-item"><a href="/whishlist" class="profile-icon nav-link"><span
										style="font-size: 20px; width: 30px; height: 30px; color: black; margin-right: 48px;"
										class="bi bi-heart"></span></a></li>
						</ul>
                </div>
            </div>
        </nav>
      </div>
   </header>
   <!-- End Header Area -->

   <!-- Start Banner Area -->
   <section class="">
      <div class="container">
         <div class="breadcrumb-banner d-flex flex-wrap align-items-center justify-content-end">
            <div class="col-first">
            </div>
         </div>
      </div>
   </section>
   <section>
      <div class="container">
         <h1 class="text-center">WALLET DETAILS</h1>
      </div>
   </section>
   <!-- Main Pages -->

   <!-- Wallet Cards  -->
   <div class="container mt-5 mb-5">
      <div class="row">
         <div class="col-md-4">
            <div class="card mb-3">
               <div class="card-body shadow">
                  <h2 class="card-title text-center">Wallet Amount</h2>
                  <h1 class="card-text text-center text-success">&#x20B9; <%- userWallet.walletAmount %></h1>
                  <div class="col-md-12 d-flex justify-content-center align-items-center">
                     <a href="" id="recharge-wallet" class="btn btn-info">Recharge Wallet</a>
                  </div>
               </div>

            </div>
         </div>
         <div class="col-md-8">
            <div class="card">
               <div class="card-body shadow">
                  <table class="table mt-4">
                     <thead>
                        <tr>
                           <th scope="col">Order ID</th>
                           <th scope="col">Debit/Credit</th>
                           <th scope="col">Amount</th>
                        </tr>
                     </thead>
                     <tbody>
                        <% if (userWallet.transactionHistory.length) { %>
                           <% let count=1; %>
                              <% for (let i=userWallet.transactionHistory.length - 1; i>= 0; i--) { %>
                                 <% if (userWallet.transactionHistory[i] < 0) { %>
                                    <tr>
                                       <td><%- count++ %></td>
                                       <td>
                                          <span class="badge rounded-pill alert-danger">Debit</span>
                                       </td>
                                       <td>
                                          <span class="text-danger">- &#x20B9; <%-
                                                Math.abs(userWallet.transactionHistory[i]) %></span>
                                       </td>
                                    </tr>
                                    <% }else{ %>
                                       <tr>
                                          <td><%- count++ %></td>
                                          <td>
                                             <span class="badge rounded-pill alert-success">Credit</span>
                                          </td>
                                          <td>
                                             <span class="text-success">+ &#x20B9; <%- userWallet.transactionHistory[i]
                                                   %></span>
                                          </td>
                                       </tr>
                                       <% } %>

                                          <% } %>
                                             <% } else { %>
                                                <p class="text-center text-danger">No Transaction Occurred</p>
                                                <% } %>


                     </tbody>
                  </table>
               </div>
            </div>
         </div>
      </div>

   </div>


   <footer class="footer-area pt-5 pb-5" style="background-color: black;  border-radius: 20px 20px 0 0;">
		<div class="container">
			<div class="row  d-flex justify-content-between">
				<div class="col-lg-3  col-md-6 col-sm-6">
					<div class="single-footer-widget">
						<h6>About Us</h6>
						<p>
							Welcome to Willink Watches, where time meets elegance. We are dedicated to providing you with
							exquisite timepieces that blend craftsmanship, style, and precision. 
							
						</p>
					</div>
				</div>
				<div class="col-lg-4  col-md-6 col-sm-6">
					<div class="single-footer-widget">
						<h6>Contact Us</h6>
						<p>Have a question or need assistance? Don't hesitate to reach out. We're here to help.</p>
						<div class="" id="mc_embed_signup">
							<p style="margin-bottom: 0px; cursor: pointer;"><span>Email : info@willinkwatches.com</span></p>
							<p style="margin-top: 0px; cursor: pointer;"> <span >Phone : +91 987654321</span></p>

						</div>
					</div>
				</div>
				<div class="col-lg-3 col-md-6 col-sm-6">
					<div class="single-footer-widget">
						<h6>Follow Us</h6>
						<p>Stay updated with our latest arrivals, promotions, and news by following us on social media.</p>
						<div class="footer-social d-flex align-items-center">
							<a href="#"><i class="fa fa-instagram"></i></a>
							<a href="#"><i class="fa fa-twitter"></i></a>
							<a href="#"><i class="fa fa-facebook"></i></a>
							<a href="#"><i class="fa fa-linkedin"></i></a>
							<a href="#"><i class="fa fa-github"></i></a>
						</div>
					</div>
				</div>
			</div>
			<div class="footer-bottom d-flex justify-content-center align-items-center flex-wrap">
				<p class="footer-text m-0">
					<!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
					Copyright &copy;
					<script>document.write(new Date().getFullYear());</script> Willink Watches | All rights reserved
					<!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
				</p>
			</div>
		</div>
	</footer>

   <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
   <script>
      document.getElementById('recharge-wallet').addEventListener('click', async (event) => {
         event.preventDefault();

         const { value: amount } = await Swal.fire({
            title: 'Enter Amount',
            input: 'number',
            inputPlaceholder: 'Enter the amount',
            inputAttributes: {
               min: '0', // Set a minimum value of 0
               step: '1', // Set the step size for the number input
            },
            showCancelButton: true,
            inputValidator: (value) => {
               if (!value || value < 0) {
                  return 'Enter a valid amount';
               }
            }
         });

         if (amount) {

            const response = await fetch('/recharge-wallet', {
               method: 'POST',
               headers: {
                  'Content-Type': 'application/json'
               },
               body: JSON.stringify({ amount }),
            })

            const result = await response.json();

            if (result.status === 'RAZORPAY') {
               razorpayPayment(result.response);
            }
         }

      })
      function razorpayPayment(order) {
         var options = {
            "key": "rzp_test_JZgdglON5nofNC", // Enter the Key ID generated from the Dashboard
            "amount": order.amount, // Amount is in currency subunits. Default currency is INR. Hence, 50000 refers to 50000 paise
            "currency": "INR",
            "name": "Willink Watches", //your business name
            "description": "Test Transaction",
            "order_id": order.id, //This is a sample Order ID. Pass the `id` obtained in the response of Step 1
            "handler": function (response) {

               verifyPayment(response, order)

            },
            "prefill": { //We recommend using the prefill parameter to auto-fill customer's contact information especially their phone number
               "name": "Gaurav Kumar", //your customer's name
               "email": "gaurav.kumar@example.com",
               "contact": "9000090000" //Provide the customer's phone number for better conversion rates 
            },
            "notes": {
               "address": "Razorpay Corporate Office"
            },

         };
         console.log(options);
         var razorpay = new Razorpay(options);
         razorpay.open();
      }

      async function verifyPayment(payment, order) {
         const data ={
            payment,
            order,
            from:'wallet'
         }
         const response = await fetch('/verify-payment', {
            method: 'POST',
            headers: {
               'Content-Type': 'application/json'
            },
            body: JSON.stringify(data),
         })

         const result = await response.json();

         if(result.status === 'rechargeSuccess'){
            Swal.fire({
               title:result.message,
               icon:'success',
               showCancelButton:false,
               showConfirmButton:false,
               timer:1000
            })
            setTimeout(()=>{
               location.href = location.href
            },1500);
         }else{
            Swal.fire({
               title:result.message,
               icon:'error',
               showCancelButton:false,
               showConfirmButton:false,
               timer:1000
            })
         }
      }

   </script>


   <script src="/user-assets/js/vendor/jquery-2.2.4.min.js"></script>
   <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js"
      integrity="sha384-b/U6ypiBEHpOf/4+1nzFpr53nxSS+GLCkfwBdFNTxtclqqenISfwAzpKaMNFNmj4"
      crossorigin="anonymous"></script>
   <script src="/user-assets/js/vendor/bootstrap.min.js"></script>
   <script src="/user-assets/js/jquery.ajaxchimp.min.js"></script>
   <script src="/user-assets/js/jquery.nice-select.min.js"></script>
   <script src="/user-assets/js/jquery.sticky.js"></script>
   <script src="/user-assets/js/nouislider.min.js"></script>
   <script src="/user-assets/js/jquery.magnific-popup.min.js"></script>
   <script src="/user-assets/js/owl.carousel.min.js"></script>
   <!--gmaps Js-->
   <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCjCGmQ0Uq4exrzdcL6rvxywDDOvfAu6eE"></script>
   <script src="/user-assets/js/gmaps.min.js"></script>
   <script src="/user-assets/js/main.js"></script>
   <script src="/js/editProfileValidation.js"></script>
   <script src="/js/changePasswordValidate.js"></script>
</body>

</html>